---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Walkthrough

Use targets.

```{r}
library(targets)
```

## The structure of _targets.R

Write a _targets.R script to the current working directory.

```r
tar_script()
```

Helper.

```{r}
show <- function(path) {
  lines <- readLines(here::here(path))
  header <- paste("\n#", path)
  out <- writeLines(c(header, lines))
  out
}
```

Show contents.

```{r comment=""}
show("_targets.R")
```


Open _targets.R for editing.

```r
tar_edit()
```

Quickly glimpse the pipeline before an expensive run.

```{r}
tar_glimpse()
```

Run a pipeline of targets.

```r
tar_make()
```

Visualise the pipeline once again (slower than `tar_glimpse()`)

```{r}
tar_visnetwork()
```

## Report using targets

Use the targets we have just made, e.g. to report the results of your analysis.

```{r}
tar_objects()

data <- tar_read(data)
plot(data)

tar_load(summary)
summary
```

## Benefit

* Add `Sys.sleep(3)` into `summ()`.
* Compare running `tar_make()` vs. this, two or more times:

```r
library(dplyr)

summ <- function(dataset) {
  Sys.sleep(3)
  summarize(dataset, mean_x = mean(x))
}

data <- data.frame(x = sample.int(100), y = sample.int(100))

system.time(
  summ(data)
)
```

